% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_3PG.R
\name{run_3PG}
\alias{run_3PG}
\title{Runs a 3-PG simulation}
\usage{
run_3PG(siteInputs, speciesInputs, forcingInputs, managementInputs = NULL,
  parameterInputs = NULL, biasInputs = NULL, settings = list(light_model =
  1, transp_model = 1, phys_model = 1, correct_bias = 0, calculate_d13c = 0),
  df_out = TRUE)
}
\arguments{
\item{siteInputs}{a \code{data frame} or \code{matrix} containing the information about site level data in the following order:
\itemize{
\item latitude: site latitude in the WGS84 coordinate system
\item soil_class: soil class, according to table 2 of 3PGpjs user manual.
\item asw_i: initial soil water in mm.
\item asw_min: minimum soil water in mm.
\item asw_max: maximum soil water in mm.
\item year_i: initial year of the simulation.
\item momth_i: initial month of the simulation, first month in the output file.
\item altitude: altitude of the site, m a.s.l.
}}

\item{speciesInputs}{a \code{data frame} or \code{matrix} containing the information about species level data. Each row corresponds to one species/layer. The following order of the collumns apply:
\itemize{
\item species: species or cohort id/name. It shall be consistent with \code{parameterInputs} and \code{biasInputs} table.
\item year_p: year when the species was planted (it is used to calculate species age at the time of simulation).
\item month_p: month when species was planted, assuming end of the month. E.g. if species is planted in January 2000, then in 31 April 2000 it will be 3 month.
\item fertility: soil fertility for a given species. Range from 0 to 1.
\item biom_foliage: initial foliage biomass (T/ha). If this is a leafless period provide a foliage biomass in summer.
\item biom_root: root biomass for a given species.
\item biom_stem: stem biomass for a given species.
\item n_trees: number of trees per ha.
}}

\item{forcingInputs}{a \code{data frame} or \code{matrix} containing the information about climatic forcing data. First month shall corresponds to \code{year_i month_i} in the \code{siteInputs} table. The required variables are (tmp_min, tmp_max, prcp, srad, frost_days)
\itemize{
\item tmp_min: monthly mean daily minimum temperature (C).
\item tmp_max: monthly mean daily maximum temperature (C).
\item tmp_ave: monthly mean daily maximum temperature (C).
\item prcp: monthly rainfall (mm month-1).
\item srad: monthly mean daily solar radiation (MJ m-2 d-1).
\item frost_days: frost days per month (d month-1).
\item vpd_day: frost days per month (mbar).
\item co2: required if calculate_d13c=1
\item d13catm: required if calculate_d13c=1
}}

\item{managementInputs}{a \code{data frame} or \code{matrix} containing the information about management. The following order apply:
\itemize{
\item species: species or cohort id/name.
\item age: age at which management is done.
\item n_trees: number of trees remaining after management
\item foliage: type of management (above/below). Default is 1.
\item root: type of management (above/below). Default is 1.
\item stem: type of management (above/below). Default is 1.
}}

\item{parameterInputs}{a \code{data frame} or \code{matrix} containing the parameters to be modified:
\itemize{
\item parameter: name of the parameter, shall be consistent in naming with \code{\link{param_info}}
\item species: each column correspond to species/cohort id/name, as defined in \code{speciesInputs} table
}}

\item{biasInputs}{a \code{data frame} or \code{matrix} containing the bias parameters to be modified:
\itemize{
\item parameter: name of the parameter, shall be consistent in naming with \code{\link{bias_info}}
\item species: each column shall correspond to species/cohort id/name, as defined in \code{speciesInputs} table
}}

\item{settings}{list with all possible settings of the model.
\itemize{
\item light_model: `1` - 3-PGpjs; `2` - 3-PGmix
\item transp_model: `1` - 3-PGpjs; `2` - 3-PGmix
\item phys_model:  `1` - 3-PGpjs; `2` - 3-PGmix
\item correct_bias: `0` - no; `1` - 3-PGmix
\item calculate_d13c: `0` - no; `1` - 3-PGmix
}}

\item{df_out}{\code{logical} if the output shall be in the 4-dimentional array (FALSE) or long data.frame (TRUE)}
}
\value{
a 4-dimentional array or a data.frame, depending on the parameter df_out. The matrix can also be transformed via the \code{\link{transf_out}} function.
}
\description{
This function runs the 3-PGpjs or 3-PGmix model
}
\details{
3PG is a relatively simple, widely used physiological forest growth model. The state variables of 3-PG are the stem, foliage and root biomass (Mg ha-1) of each cohort, the stocking (trees ha-1) of each cohort, age of each cohort, and the available soil water (mm). 3-PG then simulates the stand development via five sub-models, light, productivity, water, allocation and mortality, which update the forest structure in monthly time steps.

This implementation of 3pg includes several major variants / modifications of the model in particular the ability to switch between 3-PGpjs (the more classic model version for monospecific stands) vs. 3-PGmix (a version for mixed stands), as well as options for bias corrections and 13C calculations (see parameters).
}
\note{
The \code{run_3PG} also check for the quality of input data. In case that names, or structure is not consitent with requirenments it will return an error.
}
\examples{
out <- run_3PG(
  siteInputs = site_eum,
  speciesInputs = species_eum,
  forcingInputs = climate_eum,
  managementInputs = NULL,
  parameterInputs = parameters_eum,
  biasInputs = bias_eum,
  settings = list(light_model = 2, transp_model = 2, phys_model = 2,
                  correct_bias = 0, calculate_d13c = 0),
  df_out = TRUE)
}
